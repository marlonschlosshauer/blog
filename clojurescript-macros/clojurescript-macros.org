#+TITLE: Writing Macros that consume ClojureScript code
#+OPTIONS: toc:nil
#+LATEX_HEADER: \hypersetup{colorlinks=true,linkcolor=blue}
#+HTML_HEAD: <link rel="stylesheet" type="text/css" href="/Users/marlon/Dropbox/blog/defaults/defaults.css" />


* Basic CLJS Macro setup
For your macros to work in ClojureScript, you need to define them in a ~.clj~ file and require that namespace in your ~.cljs~ file.
#+begin_src clojure
  ;; foo.clj
  (ns example.foo)

  (defmacro code [] ...)

  ;; bar.cljs
  (ns example.bar
    (:require-macros [example.foo :as foo]))

  (foo/code)
#+end_src
* Calling CLJS functions from within your macro
Because your macro is defined in a ~.clj~ file, you cannot just import your ~.cljs~ namespace to call your functions. Rather, you have to do two things.
1. Write out the name of the function you want to use (with the complete namespace)
2. Make sure that you import the actual ~.cljs~ where you want to use the macro.

That second part is important. It insures that the namespace is in the classpath, therefore present at run-time. Here is a code example:
#+begin_src clojure
  ;; foo.clj
  (ns example.foo)

  (defmacro code []
    (exampe.bar/callme)) ;; .cljs ns is spelled out completely in the .clj file

  ;; bar.cljs
  (ns example.bar
    (:require-macros [example.foo :as foo]))

  (defn callme [])
  (foo/code)
#+end_src
* Further reading
- [[https://code.thheller.com/blog/shadow-cljs/2019/10/12/clojurescript-macros.html][ClojureScript Macros - thheller]]
